Gần như toàn bộ vương quốc Byteland được che phủ bởi những cánh rừng và các con sông. Các dòng sông nhỏ gặp nhau để tạo thành dòng sông lớn hơn. Các dòng sông lớn này lại gặp nhau và cuối cùng sẽ đều chảy về một dòng sông chính. Dòng sông chính này đổ ra biển ở gần thành phố Bytetown.  

   Có n làng thợ chặt gỗ ở Byteland, mỗi làng đặt gần một con sông. Hiện nay, có một xưởng cưa lớn Bytetown có nhiệm vụ chế biến tất cả các cây gỗ bị chặt trong vương quốc. Những cây gỗ này chảy từ các làng theo các dòng sông xuống xưởng cưa ở Bytetown. Vua Byteland quyết định sẽ xây dựng thêm k xưởng cưa ở các làng để giảm chi phí vận chuyển các cây gỗ qua đường sông. Sau khi xây dựng các trạm cưa, các cây gỗ không cần phải trôi về Bytetown mà chỉ cần trôi đến xưởng cưa đầu tiên mà chúng gặp theo dòng chảy. Hiển nhiên là những cây gỗ được đốn ở gần các làng có xưởng cưa thì không cần phải vận chuyển qua đường sông nữa. Lưu ý rằng các dòng sông ở Byteland không rẽ nhánh. Do vậy, với mỗi làng, có một đường xuôi dòng chảy duy nhất đến Bytetown.  

   Kế toán của vua đã tính được số lượng cây mỗi làng sẽ đốn mỗi năm. Bạn hãy viết chương trình giúp vua tìm các địa điểm để xây dựng xưởng cưa sao cho tổng chi phí vận chuyển các cây là nhỏ nhất. Chi phí vận chuyển theo đường sông là 1 xu mỗi kilomet, mỗi cây.
Viết chương trình nhập vào số làng, số xưởng cưa cần xây dựng thêm, số cây được cắt ở mỗi làng và sơ đồ mô tả các dòng sông, tính tổng chi phí vận chuyển nhỏ nhất có thể sau khi xây dựng thêm các xưởng cưa.