Input là một bộ gồm nhiều test. Dòng đầu của input là số test t ( t $\le$ 20 ). Tiếp sau đó là các test.   
\\   Mỗi test bắt đầu bằng một dòng trống. Dòng tiếp theo ghi một số N ( N $\le$ 10000 ). N-1 dòng tiếp theo, mỗi dòng ghi 3 số a, b và c mô tả một cạnh của cây nối a với b và có trọng số là c. Thứ tự của các cạnh chính là thứ tự xuất hiện trong input. Tiếp theo là dãy các lệnh như mô tả ở trên(số lệnh không quá 50000). Cuối mỗi test ghi một từ "DONE".   
\\   Dữ liệu vào luôn đảm bảo trọng số của các cạnh ở mỗi thời điểm có giá trị tuyệt đối không vượt quá 10000000.