Dòng đầu tiên chứa 2 số nguyên dương N và M – Số lượng hình ellipse ban đầu và số lượng truy vấn.  

   Dòng tiếp theo chứ 2n số nguyên, cặp thứ i miêu tả bán trục lớn ai và bán trục nhỏ bi của hình ellipse thứ i.  

   M dòng tiếp theo miêu tả các truy vấn KrK đề ra với định dạng sau t, l, r và v (nếu có) (1 ≤ t ≤ 6, 1 ≤ l ≤ r ≤ N) – với t là loại của truy vấn như đã miêu tả ở trên.  

   Dòng cuối cùng chứa 2 số nguyên dương A và B (Chỉ số hoàn hảo)