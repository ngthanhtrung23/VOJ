Aladdin rất thích đi khám phá vùng hoang mạc quanh thành Baghdad. Vào một đêm sáng trăng trời quang mây tạnh, Aladdin tình cờ phát hiện ra một cửa hang bí mật. Trong hang là một mê cung cực kì phức tạp. Sợ rằng nếu đâm đầu vào thì không tìm được đường ra, Aladdin không vội vào ngay mà về nhà tìm hiểu kĩ càng.

Sau nhiều ngày mài mông ở kho sách tìm đọc các tư liệu cổ, Aladdin phát hiện ra rằng mê cung này được vua Midas năm xưa xây lên để giấu kho báu. Mê cung có thể xem là một hình chữ nhật kích thước NxM, được tạo thành từ các phòng hình vuông. Mỗi phòng có nhiều nhất 4 phòng kề cạnh theo 4 hướng Đông, Tây, Nam, Bắc. Trong mỗi phòng có thể có cửa thông đến 2 phòng kề cạnh về phía Đông và Tây, hoặc 2 phòng kề cạnh theo hướng Bắc và Nam, hoặc cả bốn phòng kề cạnh. Có một số phòng không có cửa thông sang bất kì phòng nào. Một điều đặc biệt ở mê cung này (do bùa phép của vua Midas) : giả sử A và B là 2 phòng kề cạnh. \textbf{Từ A chỉ có thể trực tiếp đi đến B (hoặc ngược lại) nếu phòng A có cửa thông đến B và B cũng có cửa thông qua A (1).}

Aladdin nhận thấy mê cung nếu để nguyên thì không thể tìm được đường đến kho báu. Vậy là phải nhờ đến thần đèn : mỗi phép của thần đèn sẽ thêm các cánh cửa ma thuật vào một phòng nào đó, làm cho phòng này có đủ cả 4 cửa thông sang các phòng bên cạnh. Dĩ nhiên thần đèn không giúp đỡ không công : số phép sử dụng càng nhiều thì phần kho báu mà Aladdin phải chia cho thần đèn càng lớn. Vậy nên Aladdin sẽ cố tìm một đường đi đến kho báu mà cần phải thay đổi ít phòng nhất.

Biết rằng cửa hang dẫn trực tiếp đến phòng ở góc Tây Nam (dưới trái), còn kho báu nằm trong phòng ở góc Đông Bắc (phải trên).
Cho biết kích thước và miêu tả của mê cung. Hãy tính xem cần phải thay đổi ít nhất bao nhiêu phòng để tìm được đường đi từ cửa hang đến phòng chứa kho báu.