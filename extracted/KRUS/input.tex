Input
The first line contains two integers N and K (2 ≤ N ≤ 200, 1 ≤ K ≤ 1 000 000 000), the size of the desert and the number of direction changes in the prophecy.  

   The second line contains an integer M (0 ≤ M ≤ 10 000), the number of wizards.  

   Each of the following M lines contains two integers R and C (1 ≤ R, C ≤ N), and a string of seven letters 'L', 'R' or 'S'. The numbers represent the row and column where the wizard is located, while the string is his schedule.  

   No two wizards will share the same cell, nor will there be a wizard in cell (1, 1).